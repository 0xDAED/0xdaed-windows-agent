# Oxdaed Windows Agent

**Высокопроизводительный Windows-агент для мониторинга и управления компьютерами в инфраструктуре Oxdaed.**

Oxdaed Agent — это легковесная **Windows-служба**, которая подключает компьютер к платформе **Oxdaed** и позволяет централизованно управлять тысячами машин в реальном времени.

Агент собирает телеметрию системы, отслеживает процессы, выполняет команды с сервера и поддерживает **автоматическое обновление без ручного вмешательства**.

Проект рассчитан на использование в:

* IT-инфраструктуре
* компьютерных классах
* киберлабораториях
* корпоративных сетях
* системах удалённого администрирования

---

# Что такое Oxdaed

**Oxdaed** — это платформа управления инфраструктурой, позволяющая контролировать большое количество компьютеров из единого интерфейса.

Windows Agent — это **узел (edge-агент)**, который устанавливается на каждую машину и передает данные на backend.

Возможности системы:

• мониторинг компьютеров в реальном времени
• выполнение удалённых команд
• отслеживание процессов
• сбор системной телеметрии
• автоматическое обновление агентов
• аналитика инфраструктуры

---

# Архитектура

```
+-----------------------+
|      Oxdaed Server    |
|   FastAPI Backend     |
|   WebSocket API       |
+-----------+-----------+
            |
            |
            v
+---------------------------+
|      Oxdaed Agent         |
|      Windows Service      |
|                           |
|   heartbeat               |
|   metrics                 |
|   processes               |
|   command execution       |
|   auto update             |
+---------------------------+
            |
            v
        Windows PC
```

Агент постоянно взаимодействует с сервером через **HTTP API и WebSocket**.

---

# Основные возможности

## Мониторинг системы

Агент регулярно отправляет на сервер системные метрики:

* загрузка CPU
* использование RAM
* использование дисков
* список процессов
* версия операционной системы
* имя компьютера
* IP адрес
* текущий пользователь

Это позволяет видеть **актуальное состояние всех машин в инфраструктуре**.

---

# Выполнение удалённых команд

Сервер может отправлять агенту команды для выполнения.

Жизненный цикл команды:

```
Сервер -> отправка команды
Агент -> подтверждение получения
Агент -> выполнение
Агент -> отправка результата
```

Поддерживается выполнение:

* PowerShell команд
* CMD команд
* фоновых задач
* отслеживание статуса выполнения

---

# Мониторинг процессов

Агент собирает информацию о процессах:

* PID
* имя процесса
* загрузка CPU
* использование памяти
* состояние процесса

Это позволяет:

* контролировать активность пользователей
* выявлять подозрительные программы
* анализировать нагрузку системы

---

# Heartbeat механизм

Агент отправляет регулярные сигналы активности:

```
/agent/heartbeat
```

Heartbeat содержит:

* ID компьютера
* timestamp
* состояние агента

Благодаря этому сервер может **моментально определить, что компьютер ушёл офлайн**.

---

# Автоматические обновления

Агент поддерживает **механизм self-update**.

Процесс обновления:

```
запуск агента
     ↓
проверка manifest
     ↓
сравнение версий
     ↓
скачивание update
     ↓
запуск updater
     ↓
перезапуск службы
```

Пример update manifest:

```json
{
  "latest": "1.2.0",
  "url": "https://server/agent/agent-1.2.0.zip"
}
```

Обновление выполняется отдельным бинарником **Oxdaed.Agent.Updater**, чтобы избежать проблем с заменой файлов работающего сервиса.

---

# Структура репозитория

```
0xdaed-windows-agent
│
├── Oxdaed.Agent.Service
│   Windows служба агента
│
├── Oxdaed.Agent.Core
│   общий код
│   API клиент
│   конфигурация
│   update клиент
│
├── Oxdaed.Agent.Installer
│   установщик
│   создание службы
│   настройка прав
│
└── Oxdaed.Agent.Updater
    механизм обновления
```

---

# Установка

Запустите установщик:

```
Oxdaed.Agent.Installer.exe
```

Установщик автоматически:

• запросит права администратора
• создаст директорию установки

```
C:\Program Files\OxdaedAgent\
```

• создаст пользователя службы
• выдаст право **Log on as a service**
• создаст Windows-службу
• настроит автозапуск
• запустит агент

---

# Windows служба

Имя службы:

```
OxdaedAgent
```

Отображаемое имя:

```
Oxdaed Agent
```

Служба запускается **автоматически при старте системы**.

---

# Конфигурация

Основные параметры задаются в `AgentConfig`.

| параметр       | описание                        |
| -------------- | ------------------------------- |
| HostUrl        | сервер обновлений               |
| ApiBaseUrl     | адрес backend API               |
| PcId           | уникальный ID компьютера        |
| HeartbeatEvery | интервал heartbeat              |
| MetricsEvery   | интервал отправки метрик        |
| ProcsEvery     | интервал сканирования процессов |
| ApiKey         | ключ API                        |

---

# API endpoints

Агент использует следующие endpoints:

```
/agent/heartbeat
/agent/metrics
/agent/processes
/agent/command_ack
/agent/command_result
```

---

# Логи

Лог установщика:

```
%ProgramData%\OxdaedAgent\install.log
```

Лог обновлений:

```
%ProgramData%\Oxdaed\updates\updater.log
```

---

# Сборка проекта

Требования:

```
.NET 10 SDK
Windows
```

Сборка:

```
dotnet restore
dotnet build -c Release
```

---

# Безопасность

Установщик выполняет несколько защитных действий:

• требует права администратора
• создаёт отдельного пользователя службы
• выдаёт право `SeServiceLogonRight`
• изолирует выполнение агента

Это повышает безопасность работы агента в системе.

---

# Производительность

Агент оптимизирован для работы на большом количестве машин.

Среднее потребление ресурсов:

```
CPU: < 1%
RAM: ~20–40 MB
```

Подходит для развёртывания на **тысячах компьютеров**.

---

# Возможные применения

Oxdaed Agent используется для:

• мониторинга IT-инфраструктуры
• управления компьютерными классами
• киберполигонов
• корпоративных сетей
• SOC / security мониторинга
• удалённого администрирования

---

# Roadmap

Планируемые функции:

* удалённый рабочий стол
* передача файлов
* установка программ
* централизованные политики
* система алертов
* GPU мониторинг

---

# Oxdaed Project

```
0xDAED

```